{"ast":null,"code":"/*\r\n  Copyright (C) 2012-2013 Yusuke Suzuki <utatane.tea@gmail.com>\r\n  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>\r\n\r\n  Redistribution and use in source and binary forms, with or without\r\n  modification, are permitted provided that the following conditions are met:\r\n\r\n    * Redistributions of source code must retain the above copyright\r\n      notice, this list of conditions and the following disclaimer.\r\n    * Redistributions in binary form must reproduce the above copyright\r\n      notice, this list of conditions and the following disclaimer in the\r\n      documentation and/or other materials provided with the distribution.\r\n\r\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\r\n  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\r\n  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\r\n  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n*/\n\n/*jslint vars:false, bitwise:true*/\n\n/*jshint indent:4*/\n\n/*global exports:true*/\n(function clone(exports) {\n  'use strict';\n\n  var Syntax, VisitorOption, VisitorKeys, BREAK, SKIP, REMOVE;\n\n  function deepCopy(obj) {\n    var ret = {},\n        key,\n        val;\n\n    for (key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        val = obj[key];\n\n        if (typeof val === 'object' && val !== null) {\n          ret[key] = deepCopy(val);\n        } else {\n          ret[key] = val;\n        }\n      }\n    }\n\n    return ret;\n  } // based on LLVM libc++ upper_bound / lower_bound\n  // MIT License\n\n\n  function upperBound(array, func) {\n    var diff, len, i, current;\n    len = array.length;\n    i = 0;\n\n    while (len) {\n      diff = len >>> 1;\n      current = i + diff;\n\n      if (func(array[current])) {\n        len = diff;\n      } else {\n        i = current + 1;\n        len -= diff + 1;\n      }\n    }\n\n    return i;\n  }\n\n  Syntax = {\n    AssignmentExpression: 'AssignmentExpression',\n    AssignmentPattern: 'AssignmentPattern',\n    ArrayExpression: 'ArrayExpression',\n    ArrayPattern: 'ArrayPattern',\n    ArrowFunctionExpression: 'ArrowFunctionExpression',\n    AwaitExpression: 'AwaitExpression',\n    // CAUTION: It's deferred to ES7.\n    BlockStatement: 'BlockStatement',\n    BinaryExpression: 'BinaryExpression',\n    BreakStatement: 'BreakStatement',\n    CallExpression: 'CallExpression',\n    CatchClause: 'CatchClause',\n    ClassBody: 'ClassBody',\n    ClassDeclaration: 'ClassDeclaration',\n    ClassExpression: 'ClassExpression',\n    ComprehensionBlock: 'ComprehensionBlock',\n    // CAUTION: It's deferred to ES7.\n    ComprehensionExpression: 'ComprehensionExpression',\n    // CAUTION: It's deferred to ES7.\n    ConditionalExpression: 'ConditionalExpression',\n    ContinueStatement: 'ContinueStatement',\n    DebuggerStatement: 'DebuggerStatement',\n    DirectiveStatement: 'DirectiveStatement',\n    DoWhileStatement: 'DoWhileStatement',\n    EmptyStatement: 'EmptyStatement',\n    ExportAllDeclaration: 'ExportAllDeclaration',\n    ExportDefaultDeclaration: 'ExportDefaultDeclaration',\n    ExportNamedDeclaration: 'ExportNamedDeclaration',\n    ExportSpecifier: 'ExportSpecifier',\n    ExpressionStatement: 'ExpressionStatement',\n    ForStatement: 'ForStatement',\n    ForInStatement: 'ForInStatement',\n    ForOfStatement: 'ForOfStatement',\n    FunctionDeclaration: 'FunctionDeclaration',\n    FunctionExpression: 'FunctionExpression',\n    GeneratorExpression: 'GeneratorExpression',\n    // CAUTION: It's deferred to ES7.\n    Identifier: 'Identifier',\n    IfStatement: 'IfStatement',\n    ImportExpression: 'ImportExpression',\n    ImportDeclaration: 'ImportDeclaration',\n    ImportDefaultSpecifier: 'ImportDefaultSpecifier',\n    ImportNamespaceSpecifier: 'ImportNamespaceSpecifier',\n    ImportSpecifier: 'ImportSpecifier',\n    Literal: 'Literal',\n    LabeledStatement: 'LabeledStatement',\n    LogicalExpression: 'LogicalExpression',\n    MemberExpression: 'MemberExpression',\n    MetaProperty: 'MetaProperty',\n    MethodDefinition: 'MethodDefinition',\n    ModuleSpecifier: 'ModuleSpecifier',\n    NewExpression: 'NewExpression',\n    ObjectExpression: 'ObjectExpression',\n    ObjectPattern: 'ObjectPattern',\n    Program: 'Program',\n    Property: 'Property',\n    RestElement: 'RestElement',\n    ReturnStatement: 'ReturnStatement',\n    SequenceExpression: 'SequenceExpression',\n    SpreadElement: 'SpreadElement',\n    Super: 'Super',\n    SwitchStatement: 'SwitchStatement',\n    SwitchCase: 'SwitchCase',\n    TaggedTemplateExpression: 'TaggedTemplateExpression',\n    TemplateElement: 'TemplateElement',\n    TemplateLiteral: 'TemplateLiteral',\n    ThisExpression: 'ThisExpression',\n    ThrowStatement: 'ThrowStatement',\n    TryStatement: 'TryStatement',\n    UnaryExpression: 'UnaryExpression',\n    UpdateExpression: 'UpdateExpression',\n    VariableDeclaration: 'VariableDeclaration',\n    VariableDeclarator: 'VariableDeclarator',\n    WhileStatement: 'WhileStatement',\n    WithStatement: 'WithStatement',\n    YieldExpression: 'YieldExpression'\n  };\n  VisitorKeys = {\n    AssignmentExpression: ['left', 'right'],\n    AssignmentPattern: ['left', 'right'],\n    ArrayExpression: ['elements'],\n    ArrayPattern: ['elements'],\n    ArrowFunctionExpression: ['params', 'body'],\n    AwaitExpression: ['argument'],\n    // CAUTION: It's deferred to ES7.\n    BlockStatement: ['body'],\n    BinaryExpression: ['left', 'right'],\n    BreakStatement: ['label'],\n    CallExpression: ['callee', 'arguments'],\n    CatchClause: ['param', 'body'],\n    ClassBody: ['body'],\n    ClassDeclaration: ['id', 'superClass', 'body'],\n    ClassExpression: ['id', 'superClass', 'body'],\n    ComprehensionBlock: ['left', 'right'],\n    // CAUTION: It's deferred to ES7.\n    ComprehensionExpression: ['blocks', 'filter', 'body'],\n    // CAUTION: It's deferred to ES7.\n    ConditionalExpression: ['test', 'consequent', 'alternate'],\n    ContinueStatement: ['label'],\n    DebuggerStatement: [],\n    DirectiveStatement: [],\n    DoWhileStatement: ['body', 'test'],\n    EmptyStatement: [],\n    ExportAllDeclaration: ['source'],\n    ExportDefaultDeclaration: ['declaration'],\n    ExportNamedDeclaration: ['declaration', 'specifiers', 'source'],\n    ExportSpecifier: ['exported', 'local'],\n    ExpressionStatement: ['expression'],\n    ForStatement: ['init', 'test', 'update', 'body'],\n    ForInStatement: ['left', 'right', 'body'],\n    ForOfStatement: ['left', 'right', 'body'],\n    FunctionDeclaration: ['id', 'params', 'body'],\n    FunctionExpression: ['id', 'params', 'body'],\n    GeneratorExpression: ['blocks', 'filter', 'body'],\n    // CAUTION: It's deferred to ES7.\n    Identifier: [],\n    IfStatement: ['test', 'consequent', 'alternate'],\n    ImportExpression: ['source'],\n    ImportDeclaration: ['specifiers', 'source'],\n    ImportDefaultSpecifier: ['local'],\n    ImportNamespaceSpecifier: ['local'],\n    ImportSpecifier: ['imported', 'local'],\n    Literal: [],\n    LabeledStatement: ['label', 'body'],\n    LogicalExpression: ['left', 'right'],\n    MemberExpression: ['object', 'property'],\n    MetaProperty: ['meta', 'property'],\n    MethodDefinition: ['key', 'value'],\n    ModuleSpecifier: [],\n    NewExpression: ['callee', 'arguments'],\n    ObjectExpression: ['properties'],\n    ObjectPattern: ['properties'],\n    Program: ['body'],\n    Property: ['key', 'value'],\n    RestElement: ['argument'],\n    ReturnStatement: ['argument'],\n    SequenceExpression: ['expressions'],\n    SpreadElement: ['argument'],\n    Super: [],\n    SwitchStatement: ['discriminant', 'cases'],\n    SwitchCase: ['test', 'consequent'],\n    TaggedTemplateExpression: ['tag', 'quasi'],\n    TemplateElement: [],\n    TemplateLiteral: ['quasis', 'expressions'],\n    ThisExpression: [],\n    ThrowStatement: ['argument'],\n    TryStatement: ['block', 'handler', 'finalizer'],\n    UnaryExpression: ['argument'],\n    UpdateExpression: ['argument'],\n    VariableDeclaration: ['declarations'],\n    VariableDeclarator: ['id', 'init'],\n    WhileStatement: ['test', 'body'],\n    WithStatement: ['object', 'body'],\n    YieldExpression: ['argument']\n  }; // unique id\n\n  BREAK = {};\n  SKIP = {};\n  REMOVE = {};\n  VisitorOption = {\n    Break: BREAK,\n    Skip: SKIP,\n    Remove: REMOVE\n  };\n\n  function Reference(parent, key) {\n    this.parent = parent;\n    this.key = key;\n  }\n\n  Reference.prototype.replace = function replace(node) {\n    this.parent[this.key] = node;\n  };\n\n  Reference.prototype.remove = function remove() {\n    if (Array.isArray(this.parent)) {\n      this.parent.splice(this.key, 1);\n      return true;\n    } else {\n      this.replace(null);\n      return false;\n    }\n  };\n\n  function Element(node, path, wrap, ref) {\n    this.node = node;\n    this.path = path;\n    this.wrap = wrap;\n    this.ref = ref;\n  }\n\n  function Controller() {} // API:\n  // return property path array from root to current node\n\n\n  Controller.prototype.path = function path() {\n    var i, iz, j, jz, result, element;\n\n    function addToPath(result, path) {\n      if (Array.isArray(path)) {\n        for (j = 0, jz = path.length; j < jz; ++j) {\n          result.push(path[j]);\n        }\n      } else {\n        result.push(path);\n      }\n    } // root node\n\n\n    if (!this.__current.path) {\n      return null;\n    } // first node is sentinel, second node is root element\n\n\n    result = [];\n\n    for (i = 2, iz = this.__leavelist.length; i < iz; ++i) {\n      element = this.__leavelist[i];\n      addToPath(result, element.path);\n    }\n\n    addToPath(result, this.__current.path);\n    return result;\n  }; // API:\n  // return type of current node\n\n\n  Controller.prototype.type = function () {\n    var node = this.current();\n    return node.type || this.__current.wrap;\n  }; // API:\n  // return array of parent elements\n\n\n  Controller.prototype.parents = function parents() {\n    var i, iz, result; // first node is sentinel\n\n    result = [];\n\n    for (i = 1, iz = this.__leavelist.length; i < iz; ++i) {\n      result.push(this.__leavelist[i].node);\n    }\n\n    return result;\n  }; // API:\n  // return current node\n\n\n  Controller.prototype.current = function current() {\n    return this.__current.node;\n  };\n\n  Controller.prototype.__execute = function __execute(callback, element) {\n    var previous, result;\n    result = undefined;\n    previous = this.__current;\n    this.__current = element;\n    this.__state = null;\n\n    if (callback) {\n      result = callback.call(this, element.node, this.__leavelist[this.__leavelist.length - 1].node);\n    }\n\n    this.__current = previous;\n    return result;\n  }; // API:\n  // notify control skip / break\n\n\n  Controller.prototype.notify = function notify(flag) {\n    this.__state = flag;\n  }; // API:\n  // skip child nodes of current node\n\n\n  Controller.prototype.skip = function () {\n    this.notify(SKIP);\n  }; // API:\n  // break traversals\n\n\n  Controller.prototype['break'] = function () {\n    this.notify(BREAK);\n  }; // API:\n  // remove node\n\n\n  Controller.prototype.remove = function () {\n    this.notify(REMOVE);\n  };\n\n  Controller.prototype.__initialize = function (root, visitor) {\n    this.visitor = visitor;\n    this.root = root;\n    this.__worklist = [];\n    this.__leavelist = [];\n    this.__current = null;\n    this.__state = null;\n    this.__fallback = null;\n\n    if (visitor.fallback === 'iteration') {\n      this.__fallback = Object.keys;\n    } else if (typeof visitor.fallback === 'function') {\n      this.__fallback = visitor.fallback;\n    }\n\n    this.__keys = VisitorKeys;\n\n    if (visitor.keys) {\n      this.__keys = Object.assign(Object.create(this.__keys), visitor.keys);\n    }\n  };\n\n  function isNode(node) {\n    if (node == null) {\n      return false;\n    }\n\n    return typeof node === 'object' && typeof node.type === 'string';\n  }\n\n  function isProperty(nodeType, key) {\n    return (nodeType === Syntax.ObjectExpression || nodeType === Syntax.ObjectPattern) && 'properties' === key;\n  }\n\n  Controller.prototype.traverse = function traverse(root, visitor) {\n    var worklist, leavelist, element, node, nodeType, ret, key, current, current2, candidates, candidate, sentinel;\n\n    this.__initialize(root, visitor);\n\n    sentinel = {}; // reference\n\n    worklist = this.__worklist;\n    leavelist = this.__leavelist; // initialize\n\n    worklist.push(new Element(root, null, null, null));\n    leavelist.push(new Element(null, null, null, null));\n\n    while (worklist.length) {\n      element = worklist.pop();\n\n      if (element === sentinel) {\n        element = leavelist.pop();\n        ret = this.__execute(visitor.leave, element);\n\n        if (this.__state === BREAK || ret === BREAK) {\n          return;\n        }\n\n        continue;\n      }\n\n      if (element.node) {\n        ret = this.__execute(visitor.enter, element);\n\n        if (this.__state === BREAK || ret === BREAK) {\n          return;\n        }\n\n        worklist.push(sentinel);\n        leavelist.push(element);\n\n        if (this.__state === SKIP || ret === SKIP) {\n          continue;\n        }\n\n        node = element.node;\n        nodeType = node.type || element.wrap;\n        candidates = this.__keys[nodeType];\n\n        if (!candidates) {\n          if (this.__fallback) {\n            candidates = this.__fallback(node);\n          } else {\n            throw new Error('Unknown node type ' + nodeType + '.');\n          }\n        }\n\n        current = candidates.length;\n\n        while ((current -= 1) >= 0) {\n          key = candidates[current];\n          candidate = node[key];\n\n          if (!candidate) {\n            continue;\n          }\n\n          if (Array.isArray(candidate)) {\n            current2 = candidate.length;\n\n            while ((current2 -= 1) >= 0) {\n              if (!candidate[current2]) {\n                continue;\n              }\n\n              if (isProperty(nodeType, candidates[current])) {\n                element = new Element(candidate[current2], [key, current2], 'Property', null);\n              } else if (isNode(candidate[current2])) {\n                element = new Element(candidate[current2], [key, current2], null, null);\n              } else {\n                continue;\n              }\n\n              worklist.push(element);\n            }\n          } else if (isNode(candidate)) {\n            worklist.push(new Element(candidate, key, null, null));\n          }\n        }\n      }\n    }\n  };\n\n  Controller.prototype.replace = function replace(root, visitor) {\n    var worklist, leavelist, node, nodeType, target, element, current, current2, candidates, candidate, sentinel, outer, key;\n\n    function removeElem(element) {\n      var i, key, nextElem, parent;\n\n      if (element.ref.remove()) {\n        // When the reference is an element of an array.\n        key = element.ref.key;\n        parent = element.ref.parent; // If removed from array, then decrease following items' keys.\n\n        i = worklist.length;\n\n        while (i--) {\n          nextElem = worklist[i];\n\n          if (nextElem.ref && nextElem.ref.parent === parent) {\n            if (nextElem.ref.key < key) {\n              break;\n            }\n\n            --nextElem.ref.key;\n          }\n        }\n      }\n    }\n\n    this.__initialize(root, visitor);\n\n    sentinel = {}; // reference\n\n    worklist = this.__worklist;\n    leavelist = this.__leavelist; // initialize\n\n    outer = {\n      root: root\n    };\n    element = new Element(root, null, null, new Reference(outer, 'root'));\n    worklist.push(element);\n    leavelist.push(element);\n\n    while (worklist.length) {\n      element = worklist.pop();\n\n      if (element === sentinel) {\n        element = leavelist.pop();\n        target = this.__execute(visitor.leave, element); // node may be replaced with null,\n        // so distinguish between undefined and null in this place\n\n        if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\n          // replace\n          element.ref.replace(target);\n        }\n\n        if (this.__state === REMOVE || target === REMOVE) {\n          removeElem(element);\n        }\n\n        if (this.__state === BREAK || target === BREAK) {\n          return outer.root;\n        }\n\n        continue;\n      }\n\n      target = this.__execute(visitor.enter, element); // node may be replaced with null,\n      // so distinguish between undefined and null in this place\n\n      if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\n        // replace\n        element.ref.replace(target);\n        element.node = target;\n      }\n\n      if (this.__state === REMOVE || target === REMOVE) {\n        removeElem(element);\n        element.node = null;\n      }\n\n      if (this.__state === BREAK || target === BREAK) {\n        return outer.root;\n      } // node may be null\n\n\n      node = element.node;\n\n      if (!node) {\n        continue;\n      }\n\n      worklist.push(sentinel);\n      leavelist.push(element);\n\n      if (this.__state === SKIP || target === SKIP) {\n        continue;\n      }\n\n      nodeType = node.type || element.wrap;\n      candidates = this.__keys[nodeType];\n\n      if (!candidates) {\n        if (this.__fallback) {\n          candidates = this.__fallback(node);\n        } else {\n          throw new Error('Unknown node type ' + nodeType + '.');\n        }\n      }\n\n      current = candidates.length;\n\n      while ((current -= 1) >= 0) {\n        key = candidates[current];\n        candidate = node[key];\n\n        if (!candidate) {\n          continue;\n        }\n\n        if (Array.isArray(candidate)) {\n          current2 = candidate.length;\n\n          while ((current2 -= 1) >= 0) {\n            if (!candidate[current2]) {\n              continue;\n            }\n\n            if (isProperty(nodeType, candidates[current])) {\n              element = new Element(candidate[current2], [key, current2], 'Property', new Reference(candidate, current2));\n            } else if (isNode(candidate[current2])) {\n              element = new Element(candidate[current2], [key, current2], null, new Reference(candidate, current2));\n            } else {\n              continue;\n            }\n\n            worklist.push(element);\n          }\n        } else if (isNode(candidate)) {\n          worklist.push(new Element(candidate, key, null, new Reference(node, key)));\n        }\n      }\n    }\n\n    return outer.root;\n  };\n\n  function traverse(root, visitor) {\n    var controller = new Controller();\n    return controller.traverse(root, visitor);\n  }\n\n  function replace(root, visitor) {\n    var controller = new Controller();\n    return controller.replace(root, visitor);\n  }\n\n  function extendCommentRange(comment, tokens) {\n    var target;\n    target = upperBound(tokens, function search(token) {\n      return token.range[0] > comment.range[0];\n    });\n    comment.extendedRange = [comment.range[0], comment.range[1]];\n\n    if (target !== tokens.length) {\n      comment.extendedRange[1] = tokens[target].range[0];\n    }\n\n    target -= 1;\n\n    if (target >= 0) {\n      comment.extendedRange[0] = tokens[target].range[1];\n    }\n\n    return comment;\n  }\n\n  function attachComments(tree, providedComments, tokens) {\n    // At first, we should calculate extended comment ranges.\n    var comments = [],\n        comment,\n        len,\n        i,\n        cursor;\n\n    if (!tree.range) {\n      throw new Error('attachComments needs range information');\n    } // tokens array is empty, we attach comments to tree as 'leadingComments'\n\n\n    if (!tokens.length) {\n      if (providedComments.length) {\n        for (i = 0, len = providedComments.length; i < len; i += 1) {\n          comment = deepCopy(providedComments[i]);\n          comment.extendedRange = [0, tree.range[0]];\n          comments.push(comment);\n        }\n\n        tree.leadingComments = comments;\n      }\n\n      return tree;\n    }\n\n    for (i = 0, len = providedComments.length; i < len; i += 1) {\n      comments.push(extendCommentRange(deepCopy(providedComments[i]), tokens));\n    } // This is based on John Freeman's implementation.\n\n\n    cursor = 0;\n    traverse(tree, {\n      enter: function (node) {\n        var comment;\n\n        while (cursor < comments.length) {\n          comment = comments[cursor];\n\n          if (comment.extendedRange[1] > node.range[0]) {\n            break;\n          }\n\n          if (comment.extendedRange[1] === node.range[0]) {\n            if (!node.leadingComments) {\n              node.leadingComments = [];\n            }\n\n            node.leadingComments.push(comment);\n            comments.splice(cursor, 1);\n          } else {\n            cursor += 1;\n          }\n        } // already out of owned node\n\n\n        if (cursor === comments.length) {\n          return VisitorOption.Break;\n        }\n\n        if (comments[cursor].extendedRange[0] > node.range[1]) {\n          return VisitorOption.Skip;\n        }\n      }\n    });\n    cursor = 0;\n    traverse(tree, {\n      leave: function (node) {\n        var comment;\n\n        while (cursor < comments.length) {\n          comment = comments[cursor];\n\n          if (node.range[1] < comment.extendedRange[0]) {\n            break;\n          }\n\n          if (node.range[1] === comment.extendedRange[0]) {\n            if (!node.trailingComments) {\n              node.trailingComments = [];\n            }\n\n            node.trailingComments.push(comment);\n            comments.splice(cursor, 1);\n          } else {\n            cursor += 1;\n          }\n        } // already out of owned node\n\n\n        if (cursor === comments.length) {\n          return VisitorOption.Break;\n        }\n\n        if (comments[cursor].extendedRange[0] > node.range[1]) {\n          return VisitorOption.Skip;\n        }\n      }\n    });\n    return tree;\n  }\n\n  exports.version = require('./package.json').version;\n  exports.Syntax = Syntax;\n  exports.traverse = traverse;\n  exports.replace = replace;\n  exports.attachComments = attachComments;\n  exports.VisitorKeys = VisitorKeys;\n  exports.VisitorOption = VisitorOption;\n  exports.Controller = Controller;\n\n  exports.cloneEnvironment = function () {\n    return clone({});\n  };\n\n  return exports;\n})(exports);\n/* vim: set sw=4 ts=4 et tw=80 : */","map":{"version":3,"sources":["C:/Users/Bin Tran/Desktop/BUAG/BUAG/frontend/node_modules/estraverse/estraverse.js"],"names":["clone","exports","Syntax","VisitorOption","VisitorKeys","BREAK","SKIP","REMOVE","deepCopy","obj","ret","key","val","hasOwnProperty","upperBound","array","func","diff","len","i","current","length","AssignmentExpression","AssignmentPattern","ArrayExpression","ArrayPattern","ArrowFunctionExpression","AwaitExpression","BlockStatement","BinaryExpression","BreakStatement","CallExpression","CatchClause","ClassBody","ClassDeclaration","ClassExpression","ComprehensionBlock","ComprehensionExpression","ConditionalExpression","ContinueStatement","DebuggerStatement","DirectiveStatement","DoWhileStatement","EmptyStatement","ExportAllDeclaration","ExportDefaultDeclaration","ExportNamedDeclaration","ExportSpecifier","ExpressionStatement","ForStatement","ForInStatement","ForOfStatement","FunctionDeclaration","FunctionExpression","GeneratorExpression","Identifier","IfStatement","ImportExpression","ImportDeclaration","ImportDefaultSpecifier","ImportNamespaceSpecifier","ImportSpecifier","Literal","LabeledStatement","LogicalExpression","MemberExpression","MetaProperty","MethodDefinition","ModuleSpecifier","NewExpression","ObjectExpression","ObjectPattern","Program","Property","RestElement","ReturnStatement","SequenceExpression","SpreadElement","Super","SwitchStatement","SwitchCase","TaggedTemplateExpression","TemplateElement","TemplateLiteral","ThisExpression","ThrowStatement","TryStatement","UnaryExpression","UpdateExpression","VariableDeclaration","VariableDeclarator","WhileStatement","WithStatement","YieldExpression","Break","Skip","Remove","Reference","parent","prototype","replace","node","remove","Array","isArray","splice","Element","path","wrap","ref","Controller","iz","j","jz","result","element","addToPath","push","__current","__leavelist","type","parents","__execute","callback","previous","undefined","__state","call","notify","flag","skip","__initialize","root","visitor","__worklist","__fallback","fallback","Object","keys","__keys","assign","create","isNode","isProperty","nodeType","traverse","worklist","leavelist","current2","candidates","candidate","sentinel","pop","leave","enter","Error","target","outer","removeElem","nextElem","controller","extendCommentRange","comment","tokens","search","token","range","extendedRange","attachComments","tree","providedComments","comments","cursor","leadingComments","trailingComments","version","require","cloneEnvironment"],"mappings":"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","sourcesContent":["/*\r\n  Copyright (C) 2012-2013 Yusuke Suzuki <utatane.tea@gmail.com>\r\n  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>\r\n\r\n  Redistribution and use in source and binary forms, with or without\r\n  modification, are permitted provided that the following conditions are met:\r\n\r\n    * Redistributions of source code must retain the above copyright\r\n      notice, this list of conditions and the following disclaimer.\r\n    * Redistributions in binary form must reproduce the above copyright\r\n      notice, this list of conditions and the following disclaimer in the\r\n      documentation and/or other materials provided with the distribution.\r\n\r\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\r\n  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\r\n  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\r\n  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n*/\r\n/*jslint vars:false, bitwise:true*/\r\n/*jshint indent:4*/\r\n/*global exports:true*/\r\n(function clone(exports) {\r\n    'use strict';\r\n\r\n    var Syntax,\r\n        VisitorOption,\r\n        VisitorKeys,\r\n        BREAK,\r\n        SKIP,\r\n        REMOVE;\r\n\r\n    function deepCopy(obj) {\r\n        var ret = {}, key, val;\r\n        for (key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                val = obj[key];\r\n                if (typeof val === 'object' && val !== null) {\r\n                    ret[key] = deepCopy(val);\r\n                } else {\r\n                    ret[key] = val;\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    // based on LLVM libc++ upper_bound / lower_bound\r\n    // MIT License\r\n\r\n    function upperBound(array, func) {\r\n        var diff, len, i, current;\r\n\r\n        len = array.length;\r\n        i = 0;\r\n\r\n        while (len) {\r\n            diff = len >>> 1;\r\n            current = i + diff;\r\n            if (func(array[current])) {\r\n                len = diff;\r\n            } else {\r\n                i = current + 1;\r\n                len -= diff + 1;\r\n            }\r\n        }\r\n        return i;\r\n    }\r\n\r\n    Syntax = {\r\n        AssignmentExpression: 'AssignmentExpression',\r\n        AssignmentPattern: 'AssignmentPattern',\r\n        ArrayExpression: 'ArrayExpression',\r\n        ArrayPattern: 'ArrayPattern',\r\n        ArrowFunctionExpression: 'ArrowFunctionExpression',\r\n        AwaitExpression: 'AwaitExpression', // CAUTION: It's deferred to ES7.\r\n        BlockStatement: 'BlockStatement',\r\n        BinaryExpression: 'BinaryExpression',\r\n        BreakStatement: 'BreakStatement',\r\n        CallExpression: 'CallExpression',\r\n        CatchClause: 'CatchClause',\r\n        ClassBody: 'ClassBody',\r\n        ClassDeclaration: 'ClassDeclaration',\r\n        ClassExpression: 'ClassExpression',\r\n        ComprehensionBlock: 'ComprehensionBlock',  // CAUTION: It's deferred to ES7.\r\n        ComprehensionExpression: 'ComprehensionExpression',  // CAUTION: It's deferred to ES7.\r\n        ConditionalExpression: 'ConditionalExpression',\r\n        ContinueStatement: 'ContinueStatement',\r\n        DebuggerStatement: 'DebuggerStatement',\r\n        DirectiveStatement: 'DirectiveStatement',\r\n        DoWhileStatement: 'DoWhileStatement',\r\n        EmptyStatement: 'EmptyStatement',\r\n        ExportAllDeclaration: 'ExportAllDeclaration',\r\n        ExportDefaultDeclaration: 'ExportDefaultDeclaration',\r\n        ExportNamedDeclaration: 'ExportNamedDeclaration',\r\n        ExportSpecifier: 'ExportSpecifier',\r\n        ExpressionStatement: 'ExpressionStatement',\r\n        ForStatement: 'ForStatement',\r\n        ForInStatement: 'ForInStatement',\r\n        ForOfStatement: 'ForOfStatement',\r\n        FunctionDeclaration: 'FunctionDeclaration',\r\n        FunctionExpression: 'FunctionExpression',\r\n        GeneratorExpression: 'GeneratorExpression',  // CAUTION: It's deferred to ES7.\r\n        Identifier: 'Identifier',\r\n        IfStatement: 'IfStatement',\r\n        ImportExpression: 'ImportExpression',\r\n        ImportDeclaration: 'ImportDeclaration',\r\n        ImportDefaultSpecifier: 'ImportDefaultSpecifier',\r\n        ImportNamespaceSpecifier: 'ImportNamespaceSpecifier',\r\n        ImportSpecifier: 'ImportSpecifier',\r\n        Literal: 'Literal',\r\n        LabeledStatement: 'LabeledStatement',\r\n        LogicalExpression: 'LogicalExpression',\r\n        MemberExpression: 'MemberExpression',\r\n        MetaProperty: 'MetaProperty',\r\n        MethodDefinition: 'MethodDefinition',\r\n        ModuleSpecifier: 'ModuleSpecifier',\r\n        NewExpression: 'NewExpression',\r\n        ObjectExpression: 'ObjectExpression',\r\n        ObjectPattern: 'ObjectPattern',\r\n        Program: 'Program',\r\n        Property: 'Property',\r\n        RestElement: 'RestElement',\r\n        ReturnStatement: 'ReturnStatement',\r\n        SequenceExpression: 'SequenceExpression',\r\n        SpreadElement: 'SpreadElement',\r\n        Super: 'Super',\r\n        SwitchStatement: 'SwitchStatement',\r\n        SwitchCase: 'SwitchCase',\r\n        TaggedTemplateExpression: 'TaggedTemplateExpression',\r\n        TemplateElement: 'TemplateElement',\r\n        TemplateLiteral: 'TemplateLiteral',\r\n        ThisExpression: 'ThisExpression',\r\n        ThrowStatement: 'ThrowStatement',\r\n        TryStatement: 'TryStatement',\r\n        UnaryExpression: 'UnaryExpression',\r\n        UpdateExpression: 'UpdateExpression',\r\n        VariableDeclaration: 'VariableDeclaration',\r\n        VariableDeclarator: 'VariableDeclarator',\r\n        WhileStatement: 'WhileStatement',\r\n        WithStatement: 'WithStatement',\r\n        YieldExpression: 'YieldExpression'\r\n    };\r\n\r\n    VisitorKeys = {\r\n        AssignmentExpression: ['left', 'right'],\r\n        AssignmentPattern: ['left', 'right'],\r\n        ArrayExpression: ['elements'],\r\n        ArrayPattern: ['elements'],\r\n        ArrowFunctionExpression: ['params', 'body'],\r\n        AwaitExpression: ['argument'], // CAUTION: It's deferred to ES7.\r\n        BlockStatement: ['body'],\r\n        BinaryExpression: ['left', 'right'],\r\n        BreakStatement: ['label'],\r\n        CallExpression: ['callee', 'arguments'],\r\n        CatchClause: ['param', 'body'],\r\n        ClassBody: ['body'],\r\n        ClassDeclaration: ['id', 'superClass', 'body'],\r\n        ClassExpression: ['id', 'superClass', 'body'],\r\n        ComprehensionBlock: ['left', 'right'],  // CAUTION: It's deferred to ES7.\r\n        ComprehensionExpression: ['blocks', 'filter', 'body'],  // CAUTION: It's deferred to ES7.\r\n        ConditionalExpression: ['test', 'consequent', 'alternate'],\r\n        ContinueStatement: ['label'],\r\n        DebuggerStatement: [],\r\n        DirectiveStatement: [],\r\n        DoWhileStatement: ['body', 'test'],\r\n        EmptyStatement: [],\r\n        ExportAllDeclaration: ['source'],\r\n        ExportDefaultDeclaration: ['declaration'],\r\n        ExportNamedDeclaration: ['declaration', 'specifiers', 'source'],\r\n        ExportSpecifier: ['exported', 'local'],\r\n        ExpressionStatement: ['expression'],\r\n        ForStatement: ['init', 'test', 'update', 'body'],\r\n        ForInStatement: ['left', 'right', 'body'],\r\n        ForOfStatement: ['left', 'right', 'body'],\r\n        FunctionDeclaration: ['id', 'params', 'body'],\r\n        FunctionExpression: ['id', 'params', 'body'],\r\n        GeneratorExpression: ['blocks', 'filter', 'body'],  // CAUTION: It's deferred to ES7.\r\n        Identifier: [],\r\n        IfStatement: ['test', 'consequent', 'alternate'],\r\n        ImportExpression: ['source'],\r\n        ImportDeclaration: ['specifiers', 'source'],\r\n        ImportDefaultSpecifier: ['local'],\r\n        ImportNamespaceSpecifier: ['local'],\r\n        ImportSpecifier: ['imported', 'local'],\r\n        Literal: [],\r\n        LabeledStatement: ['label', 'body'],\r\n        LogicalExpression: ['left', 'right'],\r\n        MemberExpression: ['object', 'property'],\r\n        MetaProperty: ['meta', 'property'],\r\n        MethodDefinition: ['key', 'value'],\r\n        ModuleSpecifier: [],\r\n        NewExpression: ['callee', 'arguments'],\r\n        ObjectExpression: ['properties'],\r\n        ObjectPattern: ['properties'],\r\n        Program: ['body'],\r\n        Property: ['key', 'value'],\r\n        RestElement: [ 'argument' ],\r\n        ReturnStatement: ['argument'],\r\n        SequenceExpression: ['expressions'],\r\n        SpreadElement: ['argument'],\r\n        Super: [],\r\n        SwitchStatement: ['discriminant', 'cases'],\r\n        SwitchCase: ['test', 'consequent'],\r\n        TaggedTemplateExpression: ['tag', 'quasi'],\r\n        TemplateElement: [],\r\n        TemplateLiteral: ['quasis', 'expressions'],\r\n        ThisExpression: [],\r\n        ThrowStatement: ['argument'],\r\n        TryStatement: ['block', 'handler', 'finalizer'],\r\n        UnaryExpression: ['argument'],\r\n        UpdateExpression: ['argument'],\r\n        VariableDeclaration: ['declarations'],\r\n        VariableDeclarator: ['id', 'init'],\r\n        WhileStatement: ['test', 'body'],\r\n        WithStatement: ['object', 'body'],\r\n        YieldExpression: ['argument']\r\n    };\r\n\r\n    // unique id\r\n    BREAK = {};\r\n    SKIP = {};\r\n    REMOVE = {};\r\n\r\n    VisitorOption = {\r\n        Break: BREAK,\r\n        Skip: SKIP,\r\n        Remove: REMOVE\r\n    };\r\n\r\n    function Reference(parent, key) {\r\n        this.parent = parent;\r\n        this.key = key;\r\n    }\r\n\r\n    Reference.prototype.replace = function replace(node) {\r\n        this.parent[this.key] = node;\r\n    };\r\n\r\n    Reference.prototype.remove = function remove() {\r\n        if (Array.isArray(this.parent)) {\r\n            this.parent.splice(this.key, 1);\r\n            return true;\r\n        } else {\r\n            this.replace(null);\r\n            return false;\r\n        }\r\n    };\r\n\r\n    function Element(node, path, wrap, ref) {\r\n        this.node = node;\r\n        this.path = path;\r\n        this.wrap = wrap;\r\n        this.ref = ref;\r\n    }\r\n\r\n    function Controller() { }\r\n\r\n    // API:\r\n    // return property path array from root to current node\r\n    Controller.prototype.path = function path() {\r\n        var i, iz, j, jz, result, element;\r\n\r\n        function addToPath(result, path) {\r\n            if (Array.isArray(path)) {\r\n                for (j = 0, jz = path.length; j < jz; ++j) {\r\n                    result.push(path[j]);\r\n                }\r\n            } else {\r\n                result.push(path);\r\n            }\r\n        }\r\n\r\n        // root node\r\n        if (!this.__current.path) {\r\n            return null;\r\n        }\r\n\r\n        // first node is sentinel, second node is root element\r\n        result = [];\r\n        for (i = 2, iz = this.__leavelist.length; i < iz; ++i) {\r\n            element = this.__leavelist[i];\r\n            addToPath(result, element.path);\r\n        }\r\n        addToPath(result, this.__current.path);\r\n        return result;\r\n    };\r\n\r\n    // API:\r\n    // return type of current node\r\n    Controller.prototype.type = function () {\r\n        var node = this.current();\r\n        return node.type || this.__current.wrap;\r\n    };\r\n\r\n    // API:\r\n    // return array of parent elements\r\n    Controller.prototype.parents = function parents() {\r\n        var i, iz, result;\r\n\r\n        // first node is sentinel\r\n        result = [];\r\n        for (i = 1, iz = this.__leavelist.length; i < iz; ++i) {\r\n            result.push(this.__leavelist[i].node);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    // API:\r\n    // return current node\r\n    Controller.prototype.current = function current() {\r\n        return this.__current.node;\r\n    };\r\n\r\n    Controller.prototype.__execute = function __execute(callback, element) {\r\n        var previous, result;\r\n\r\n        result = undefined;\r\n\r\n        previous  = this.__current;\r\n        this.__current = element;\r\n        this.__state = null;\r\n        if (callback) {\r\n            result = callback.call(this, element.node, this.__leavelist[this.__leavelist.length - 1].node);\r\n        }\r\n        this.__current = previous;\r\n\r\n        return result;\r\n    };\r\n\r\n    // API:\r\n    // notify control skip / break\r\n    Controller.prototype.notify = function notify(flag) {\r\n        this.__state = flag;\r\n    };\r\n\r\n    // API:\r\n    // skip child nodes of current node\r\n    Controller.prototype.skip = function () {\r\n        this.notify(SKIP);\r\n    };\r\n\r\n    // API:\r\n    // break traversals\r\n    Controller.prototype['break'] = function () {\r\n        this.notify(BREAK);\r\n    };\r\n\r\n    // API:\r\n    // remove node\r\n    Controller.prototype.remove = function () {\r\n        this.notify(REMOVE);\r\n    };\r\n\r\n    Controller.prototype.__initialize = function(root, visitor) {\r\n        this.visitor = visitor;\r\n        this.root = root;\r\n        this.__worklist = [];\r\n        this.__leavelist = [];\r\n        this.__current = null;\r\n        this.__state = null;\r\n        this.__fallback = null;\r\n        if (visitor.fallback === 'iteration') {\r\n            this.__fallback = Object.keys;\r\n        } else if (typeof visitor.fallback === 'function') {\r\n            this.__fallback = visitor.fallback;\r\n        }\r\n\r\n        this.__keys = VisitorKeys;\r\n        if (visitor.keys) {\r\n            this.__keys = Object.assign(Object.create(this.__keys), visitor.keys);\r\n        }\r\n    };\r\n\r\n    function isNode(node) {\r\n        if (node == null) {\r\n            return false;\r\n        }\r\n        return typeof node === 'object' && typeof node.type === 'string';\r\n    }\r\n\r\n    function isProperty(nodeType, key) {\r\n        return (nodeType === Syntax.ObjectExpression || nodeType === Syntax.ObjectPattern) && 'properties' === key;\r\n    }\r\n\r\n    Controller.prototype.traverse = function traverse(root, visitor) {\r\n        var worklist,\r\n            leavelist,\r\n            element,\r\n            node,\r\n            nodeType,\r\n            ret,\r\n            key,\r\n            current,\r\n            current2,\r\n            candidates,\r\n            candidate,\r\n            sentinel;\r\n\r\n        this.__initialize(root, visitor);\r\n\r\n        sentinel = {};\r\n\r\n        // reference\r\n        worklist = this.__worklist;\r\n        leavelist = this.__leavelist;\r\n\r\n        // initialize\r\n        worklist.push(new Element(root, null, null, null));\r\n        leavelist.push(new Element(null, null, null, null));\r\n\r\n        while (worklist.length) {\r\n            element = worklist.pop();\r\n\r\n            if (element === sentinel) {\r\n                element = leavelist.pop();\r\n\r\n                ret = this.__execute(visitor.leave, element);\r\n\r\n                if (this.__state === BREAK || ret === BREAK) {\r\n                    return;\r\n                }\r\n                continue;\r\n            }\r\n\r\n            if (element.node) {\r\n\r\n                ret = this.__execute(visitor.enter, element);\r\n\r\n                if (this.__state === BREAK || ret === BREAK) {\r\n                    return;\r\n                }\r\n\r\n                worklist.push(sentinel);\r\n                leavelist.push(element);\r\n\r\n                if (this.__state === SKIP || ret === SKIP) {\r\n                    continue;\r\n                }\r\n\r\n                node = element.node;\r\n                nodeType = node.type || element.wrap;\r\n                candidates = this.__keys[nodeType];\r\n                if (!candidates) {\r\n                    if (this.__fallback) {\r\n                        candidates = this.__fallback(node);\r\n                    } else {\r\n                        throw new Error('Unknown node type ' + nodeType + '.');\r\n                    }\r\n                }\r\n\r\n                current = candidates.length;\r\n                while ((current -= 1) >= 0) {\r\n                    key = candidates[current];\r\n                    candidate = node[key];\r\n                    if (!candidate) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Array.isArray(candidate)) {\r\n                        current2 = candidate.length;\r\n                        while ((current2 -= 1) >= 0) {\r\n                            if (!candidate[current2]) {\r\n                                continue;\r\n                            }\r\n                            if (isProperty(nodeType, candidates[current])) {\r\n                                element = new Element(candidate[current2], [key, current2], 'Property', null);\r\n                            } else if (isNode(candidate[current2])) {\r\n                                element = new Element(candidate[current2], [key, current2], null, null);\r\n                            } else {\r\n                                continue;\r\n                            }\r\n                            worklist.push(element);\r\n                        }\r\n                    } else if (isNode(candidate)) {\r\n                        worklist.push(new Element(candidate, key, null, null));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    Controller.prototype.replace = function replace(root, visitor) {\r\n        var worklist,\r\n            leavelist,\r\n            node,\r\n            nodeType,\r\n            target,\r\n            element,\r\n            current,\r\n            current2,\r\n            candidates,\r\n            candidate,\r\n            sentinel,\r\n            outer,\r\n            key;\r\n\r\n        function removeElem(element) {\r\n            var i,\r\n                key,\r\n                nextElem,\r\n                parent;\r\n\r\n            if (element.ref.remove()) {\r\n                // When the reference is an element of an array.\r\n                key = element.ref.key;\r\n                parent = element.ref.parent;\r\n\r\n                // If removed from array, then decrease following items' keys.\r\n                i = worklist.length;\r\n                while (i--) {\r\n                    nextElem = worklist[i];\r\n                    if (nextElem.ref && nextElem.ref.parent === parent) {\r\n                        if  (nextElem.ref.key < key) {\r\n                            break;\r\n                        }\r\n                        --nextElem.ref.key;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.__initialize(root, visitor);\r\n\r\n        sentinel = {};\r\n\r\n        // reference\r\n        worklist = this.__worklist;\r\n        leavelist = this.__leavelist;\r\n\r\n        // initialize\r\n        outer = {\r\n            root: root\r\n        };\r\n        element = new Element(root, null, null, new Reference(outer, 'root'));\r\n        worklist.push(element);\r\n        leavelist.push(element);\r\n\r\n        while (worklist.length) {\r\n            element = worklist.pop();\r\n\r\n            if (element === sentinel) {\r\n                element = leavelist.pop();\r\n\r\n                target = this.__execute(visitor.leave, element);\r\n\r\n                // node may be replaced with null,\r\n                // so distinguish between undefined and null in this place\r\n                if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\r\n                    // replace\r\n                    element.ref.replace(target);\r\n                }\r\n\r\n                if (this.__state === REMOVE || target === REMOVE) {\r\n                    removeElem(element);\r\n                }\r\n\r\n                if (this.__state === BREAK || target === BREAK) {\r\n                    return outer.root;\r\n                }\r\n                continue;\r\n            }\r\n\r\n            target = this.__execute(visitor.enter, element);\r\n\r\n            // node may be replaced with null,\r\n            // so distinguish between undefined and null in this place\r\n            if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\r\n                // replace\r\n                element.ref.replace(target);\r\n                element.node = target;\r\n            }\r\n\r\n            if (this.__state === REMOVE || target === REMOVE) {\r\n                removeElem(element);\r\n                element.node = null;\r\n            }\r\n\r\n            if (this.__state === BREAK || target === BREAK) {\r\n                return outer.root;\r\n            }\r\n\r\n            // node may be null\r\n            node = element.node;\r\n            if (!node) {\r\n                continue;\r\n            }\r\n\r\n            worklist.push(sentinel);\r\n            leavelist.push(element);\r\n\r\n            if (this.__state === SKIP || target === SKIP) {\r\n                continue;\r\n            }\r\n\r\n            nodeType = node.type || element.wrap;\r\n            candidates = this.__keys[nodeType];\r\n            if (!candidates) {\r\n                if (this.__fallback) {\r\n                    candidates = this.__fallback(node);\r\n                } else {\r\n                    throw new Error('Unknown node type ' + nodeType + '.');\r\n                }\r\n            }\r\n\r\n            current = candidates.length;\r\n            while ((current -= 1) >= 0) {\r\n                key = candidates[current];\r\n                candidate = node[key];\r\n                if (!candidate) {\r\n                    continue;\r\n                }\r\n\r\n                if (Array.isArray(candidate)) {\r\n                    current2 = candidate.length;\r\n                    while ((current2 -= 1) >= 0) {\r\n                        if (!candidate[current2]) {\r\n                            continue;\r\n                        }\r\n                        if (isProperty(nodeType, candidates[current])) {\r\n                            element = new Element(candidate[current2], [key, current2], 'Property', new Reference(candidate, current2));\r\n                        } else if (isNode(candidate[current2])) {\r\n                            element = new Element(candidate[current2], [key, current2], null, new Reference(candidate, current2));\r\n                        } else {\r\n                            continue;\r\n                        }\r\n                        worklist.push(element);\r\n                    }\r\n                } else if (isNode(candidate)) {\r\n                    worklist.push(new Element(candidate, key, null, new Reference(node, key)));\r\n                }\r\n            }\r\n        }\r\n\r\n        return outer.root;\r\n    };\r\n\r\n    function traverse(root, visitor) {\r\n        var controller = new Controller();\r\n        return controller.traverse(root, visitor);\r\n    }\r\n\r\n    function replace(root, visitor) {\r\n        var controller = new Controller();\r\n        return controller.replace(root, visitor);\r\n    }\r\n\r\n    function extendCommentRange(comment, tokens) {\r\n        var target;\r\n\r\n        target = upperBound(tokens, function search(token) {\r\n            return token.range[0] > comment.range[0];\r\n        });\r\n\r\n        comment.extendedRange = [comment.range[0], comment.range[1]];\r\n\r\n        if (target !== tokens.length) {\r\n            comment.extendedRange[1] = tokens[target].range[0];\r\n        }\r\n\r\n        target -= 1;\r\n        if (target >= 0) {\r\n            comment.extendedRange[0] = tokens[target].range[1];\r\n        }\r\n\r\n        return comment;\r\n    }\r\n\r\n    function attachComments(tree, providedComments, tokens) {\r\n        // At first, we should calculate extended comment ranges.\r\n        var comments = [], comment, len, i, cursor;\r\n\r\n        if (!tree.range) {\r\n            throw new Error('attachComments needs range information');\r\n        }\r\n\r\n        // tokens array is empty, we attach comments to tree as 'leadingComments'\r\n        if (!tokens.length) {\r\n            if (providedComments.length) {\r\n                for (i = 0, len = providedComments.length; i < len; i += 1) {\r\n                    comment = deepCopy(providedComments[i]);\r\n                    comment.extendedRange = [0, tree.range[0]];\r\n                    comments.push(comment);\r\n                }\r\n                tree.leadingComments = comments;\r\n            }\r\n            return tree;\r\n        }\r\n\r\n        for (i = 0, len = providedComments.length; i < len; i += 1) {\r\n            comments.push(extendCommentRange(deepCopy(providedComments[i]), tokens));\r\n        }\r\n\r\n        // This is based on John Freeman's implementation.\r\n        cursor = 0;\r\n        traverse(tree, {\r\n            enter: function (node) {\r\n                var comment;\r\n\r\n                while (cursor < comments.length) {\r\n                    comment = comments[cursor];\r\n                    if (comment.extendedRange[1] > node.range[0]) {\r\n                        break;\r\n                    }\r\n\r\n                    if (comment.extendedRange[1] === node.range[0]) {\r\n                        if (!node.leadingComments) {\r\n                            node.leadingComments = [];\r\n                        }\r\n                        node.leadingComments.push(comment);\r\n                        comments.splice(cursor, 1);\r\n                    } else {\r\n                        cursor += 1;\r\n                    }\r\n                }\r\n\r\n                // already out of owned node\r\n                if (cursor === comments.length) {\r\n                    return VisitorOption.Break;\r\n                }\r\n\r\n                if (comments[cursor].extendedRange[0] > node.range[1]) {\r\n                    return VisitorOption.Skip;\r\n                }\r\n            }\r\n        });\r\n\r\n        cursor = 0;\r\n        traverse(tree, {\r\n            leave: function (node) {\r\n                var comment;\r\n\r\n                while (cursor < comments.length) {\r\n                    comment = comments[cursor];\r\n                    if (node.range[1] < comment.extendedRange[0]) {\r\n                        break;\r\n                    }\r\n\r\n                    if (node.range[1] === comment.extendedRange[0]) {\r\n                        if (!node.trailingComments) {\r\n                            node.trailingComments = [];\r\n                        }\r\n                        node.trailingComments.push(comment);\r\n                        comments.splice(cursor, 1);\r\n                    } else {\r\n                        cursor += 1;\r\n                    }\r\n                }\r\n\r\n                // already out of owned node\r\n                if (cursor === comments.length) {\r\n                    return VisitorOption.Break;\r\n                }\r\n\r\n                if (comments[cursor].extendedRange[0] > node.range[1]) {\r\n                    return VisitorOption.Skip;\r\n                }\r\n            }\r\n        });\r\n\r\n        return tree;\r\n    }\r\n\r\n    exports.version = require('./package.json').version;\r\n    exports.Syntax = Syntax;\r\n    exports.traverse = traverse;\r\n    exports.replace = replace;\r\n    exports.attachComments = attachComments;\r\n    exports.VisitorKeys = VisitorKeys;\r\n    exports.VisitorOption = VisitorOption;\r\n    exports.Controller = Controller;\r\n    exports.cloneEnvironment = function () { return clone({}); };\r\n\r\n    return exports;\r\n}(exports));\r\n/* vim: set sw=4 ts=4 et tw=80 : */\r\n"]},"metadata":{},"sourceType":"script"}