{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Trang Tran\\\\Desktop\\\\Project\\\\frontend\\\\src\\\\features\\\\container\\\\detailtour\\\\tour\\\\Tour.js\",\n    _s = $RefreshSig$();\n\nimport { Carousel, message, Popover, Radio, Rate, Spin } from 'antd';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport './tour.css';\nimport { Button } from '@material-ui/core';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport Detail from '../detail/Detail';\nimport Footer from '../../trangchu/footer/Footer';\nimport Modal from 'antd/lib/modal/Modal';\nimport Hinhthucthanhtoan from './Hinhthucthanhtoan';\nimport Dieukhoan from './Dieukhoan';\nimport taikhoanApi from '../../../../api/taikhoanApi';\nimport { ngaydiData } from '../../admin/Ngaydi/ngaydiSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Tour(props) {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const [state, setState] = useState({\n    listdate: '',\n    visible: false,\n    visible2: false,\n    visible3: false,\n    name: \"\",\n    email: \"\",\n    sdt: \"\",\n    diachi: \"\",\n    nguoilon: 1,\n    treem: 0,\n    embe: 0,\n    dieukhoan: false,\n    valueDate: \"\",\n    date: \"\",\n    loadlaihoadon: 1\n  });\n  const dispatch = useDispatch();\n\n  const actionngaydi = async () => {\n    await dispatch(ngaydiData());\n  };\n\n  const tours = useSelector(state => state.tours.tour.data);\n  const ngaydis = useSelector(state => state.ngaydis.ngaydi.data);\n  const tour = [];\n\n  if (tours) {\n    for (let i = 0; i < tours.length; i++) {\n      if (tours[i].id === +id) {\n        tour.push(tours[i].Ngaydis);\n      }\n    }\n  }\n\n  var giakhuyenmai;\n\n  if (tours) {\n    giakhuyenmai = tours.find(x => x.id === +id);\n  }\n\n  const formatdate = e => {\n    if (e) {\n      var ngay = e.substr(0, 2);\n      var thang = e.substr(3, 2);\n      var nam = e.substr(6, 4);\n      return nam + '-' + thang + '-' + ngay;\n    }\n  };\n\n  const checkngaydi = () => {\n    if (tour.length !== 0) {\n      // console.log(tour);\n      var ngaydi = tour[0];\n      var ngaymin = formatdate(ngaydi[0].ngay);\n      var date = new Date(); // var dateToday = date.getFullYear() + \"-\" + ((date.getMonth() + 1) > 1 ? date.getMonth() + 1 : (\"0\" + (date.getMonth() + 1))) + \"-\" + (date.getDate() > 1 ? date.getDate() : (\"0\" + date.getDate()));\n\n      var listDate = [];\n\n      for (let i = 0; i < ngaydi.length; i++) {\n        if (new Date(ngaymin) < new Date(formatdate(ngaydi[i].ngay)) && date <= new Date(formatdate(ngaydi[i].ngay))) {\n          listDate.push(formatdate(ngaydi[i].ngay));\n        }\n      } // console.log(listDate.sort((a, b) => { return new Date(b) - new Date(a) }));\n\n\n      listDate.sort(function (a, b) {\n        return new Date(a) - new Date(b);\n      });\n      return listDate[0];\n    }\n  };\n\n  const fillDate = () => {\n    if (tour.length !== 0) {\n      var ngaydi = tour[0];\n      var date = new Date();\n      var dates = [];\n      var dateToday = date.getFullYear() + \"-\" + (date.getMonth() + 1 > 1 ? date.getMonth() + 1 : \"0\" + (date.getMonth() + 1)) + \"-\" + (date.getDate() > 1 ? date.getDate() : \"0\" + date.getDate());\n\n      for (let i = 0; i < ngaydi.length; i++) {\n        console.log(dateToday <= formatdate(ngaydi[i].ngay));\n\n        if (date <= new Date(formatdate(ngaydi[i].ngay))) {\n          dates.push({\n            id: i + 1,\n            ngay: ngaydi[i].ngay\n          });\n        }\n      }\n\n      return dates;\n    }\n  };\n\n  const formatlaidate = e => {\n    if (e) {\n      var ngay = e.substr(8, 2);\n      var thang = e.substr(5, 2);\n      var nam = e.substr(0, 4);\n      return ngay + \"/\" + thang + \"/\" + nam;\n    }\n  };\n\n  var tour_ngay = [];\n\n  if (ngaydis && formatlaidate(checkngaydi())) {\n    tour_ngay.push(ngaydis.find(x => x.ngay === formatlaidate(checkngaydi())).Tours.find(x => x.id === +id));\n  }\n\n  console.log(tour_ngay);\n\n  const hide = () => {\n    setState({ ...state,\n      visible3: false\n    });\n  };\n\n  const handleVisibleChange = () => {\n    setState({ ...state,\n      visible3: true,\n      listdate: fillDate()\n    });\n  };\n\n  const users = useSelector(state => state.infor.infor.data);\n  useEffect(() => {\n    actionngaydi();\n    window.scrollTo(0, 0);\n  }, [state.loadlaihoadon]);\n\n  const showModal = async () => {\n    if (users) {\n      var user = await taikhoanApi.getOne(+users.id).then(data => {\n        return data;\n      });\n      setState({ ...state,\n        visible3: false,\n        visible: true,\n        name: user.name,\n        diachi: user.diachi,\n        sdt: user.sdt,\n        email: user.email\n      });\n    } else {\n      message.warning(\"Bạn cần đăng nhập trước!\");\n    }\n  };\n\n  const handleOk = e => {\n    if (name === \"\" || sdt === \"\" || diachi === \"\" || email === \"\" || !name || !sdt || !diachi || !email) {\n      message.warning('Bạn cần cập nhật thông tin cho tài khoản!');\n    } else {\n      setState({ ...state,\n        visible2: true\n      });\n    }\n  };\n\n  const handleCancel = e => {\n    setState({ ...state,\n      visible: false\n    });\n  };\n\n  const thanhtien = (gia_te, gia_eb) => {\n    var gianguoilon = checkKhuyenmai();\n    return gianguoilon * nguoilon + gia_te * treem + gia_eb * embe;\n  };\n\n  const [stylepayment, setstylepayment] = useState(1);\n\n  const callbackfunction = data => {\n    setstylepayment(data);\n  };\n\n  const history = useHistory();\n\n  const handleOk2 = async () => {\n    if (state.dieukhoan === false) {\n      message.warning(\"Bạn chưa đồng ý điều khoản của chúng tôi!\");\n    } else {\n      var userId = await taikhoanApi.getOne(+users.id).then(data => {\n        return data.id;\n      });\n      var tourId = id;\n      let tongtien = thanhtien(tour_ngay[0].giatreem, tour_ngay[0].giaembe);\n    }\n  };\n\n  const handleCancel2 = e => {\n    setState({ ...state,\n      visible2: false\n    });\n  };\n\n  const onchange = e => {\n    setState({ ...state,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const onChangedate = e => {\n    setState({ ...state,\n      valueDate: e.target.value\n    });\n  };\n\n  const tinhkhuyenmai = (money, km) => {\n    return money - money * (km / 100);\n  };\n\n  const {\n    name,\n    sdt,\n    diachi,\n    email,\n    nguoilon,\n    treem,\n    embe\n  } = state;\n\n  const checkKhuyenmai = () => {\n    if (giakhuyenmai.Khuyenmais.length === 0) {\n      return giakhuyenmai.gianguoilon;\n    } else {\n      if (giakhuyenmai.Khuyenmais[0].status === 0) {\n        return giakhuyenmai.gianguoilon;\n      } else {\n        return tinhkhuyenmai(giakhuyenmai.gianguoilon, giakhuyenmai.Khuyenmais[0].khuyenmai);\n      }\n    }\n  };\n\n  const radioStyle = {\n    display: 'block',\n    height: '30px',\n    lineHeight: '30px'\n  };\n\n  const adddate = e => {\n    setState({ ...state,\n      date: state.listdate.find(x => x.id === +e).ngay\n    });\n  };\n\n  var tong;\n\n  if (giakhuyenmai) {\n    tong = Number(nguoilon) + Number(treem) + Number(embe);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"detail-tour\",\n    children: /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Hello\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 232,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Tour, \"SjH7t39pS+HJZdlrzMnJ2prUixA=\", false, function () {\n  return [useParams, useDispatch, useSelector, useSelector, useSelector, useHistory];\n});\n\n_c = Tour;\nexport default Tour;\n\nvar _c;\n\n$RefreshReg$(_c, \"Tour\");","map":{"version":3,"sources":["C:/Users/Trang Tran/Desktop/Project/frontend/src/features/container/detailtour/tour/Tour.js"],"names":["Carousel","message","Popover","Radio","Rate","Spin","React","useEffect","useState","useDispatch","useSelector","Button","Link","useHistory","useParams","Detail","Footer","Modal","Hinhthucthanhtoan","Dieukhoan","taikhoanApi","ngaydiData","Tour","props","id","state","setState","listdate","visible","visible2","visible3","name","email","sdt","diachi","nguoilon","treem","embe","dieukhoan","valueDate","date","loadlaihoadon","dispatch","actionngaydi","tours","tour","data","ngaydis","ngaydi","i","length","push","Ngaydis","giakhuyenmai","find","x","formatdate","e","ngay","substr","thang","nam","checkngaydi","ngaymin","Date","listDate","sort","a","b","fillDate","dates","dateToday","getFullYear","getMonth","getDate","console","log","formatlaidate","tour_ngay","Tours","hide","handleVisibleChange","users","infor","window","scrollTo","showModal","user","getOne","then","warning","handleOk","handleCancel","thanhtien","gia_te","gia_eb","gianguoilon","checkKhuyenmai","stylepayment","setstylepayment","callbackfunction","history","handleOk2","userId","tourId","tongtien","giatreem","giaembe","handleCancel2","onchange","target","value","onChangedate","tinhkhuyenmai","money","km","Khuyenmais","status","khuyenmai","radioStyle","display","height","lineHeight","adddate","tong","Number"],"mappings":"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","sourcesContent":["import { Carousel, message, Popover, Radio, Rate, Spin } from 'antd'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport './tour.css'\r\nimport { Button } from '@material-ui/core';\r\nimport { Link, useHistory, useParams } from 'react-router-dom';\r\nimport Detail from '../detail/Detail';\r\nimport Footer from '../../trangchu/footer/Footer'\r\nimport Modal from 'antd/lib/modal/Modal';\r\nimport Hinhthucthanhtoan from './Hinhthucthanhtoan'\r\nimport Dieukhoan from './Dieukhoan'\r\nimport taikhoanApi from '../../../../api/taikhoanApi';\r\nimport { ngaydiData } from '../../admin/Ngaydi/ngaydiSlice';\r\nfunction Tour(props) {\r\n  const { id } = useParams()\r\n  const [state, setState] = useState({\r\n    listdate: '',\r\n    visible: false,\r\n    visible2: false,\r\n    visible3: false,\r\n    name: \"\",\r\n    email: \"\",\r\n    sdt: \"\",\r\n    diachi: \"\",\r\n    nguoilon: 1,\r\n    treem: 0,\r\n    embe: 0,\r\n    dieukhoan: false,\r\n    valueDate: \"\",\r\n    date: \"\",\r\n    loadlaihoadon: 1,\r\n  })\r\n \r\n\r\n  \r\n\r\n  const dispatch = useDispatch();\r\n  const actionngaydi = async () => { await dispatch(ngaydiData()) }\r\n\r\n  const tours = useSelector(state => state.tours.tour.data);\r\n  const ngaydis = useSelector(state => state.ngaydis.ngaydi.data);\r\n\r\n  const tour = [];\r\n  if (tours) {\r\n    for (let i = 0; i < tours.length; i++) {\r\n      if (tours[i].id === +id) {\r\n        tour.push(tours[i].Ngaydis)\r\n      }\r\n    }\r\n  }\r\n  var giakhuyenmai\r\n  if (tours) {\r\n    giakhuyenmai = tours.find(x => x.id === +id);\r\n  }\r\n  const formatdate = e => {\r\n    if (e) {\r\n      var ngay = e.substr(0, 2)\r\n      var thang = e.substr(3, 2)\r\n      var nam = e.substr(6, 4)\r\n      return nam + '-' + thang + '-' + ngay;\r\n    }\r\n  }\r\n  const checkngaydi = () => {\r\n    if (tour.length !== 0) {\r\n      // console.log(tour);\r\n      var ngaydi = tour[0];\r\n      var ngaymin = formatdate(ngaydi[0].ngay);\r\n      var date = new Date();\r\n      // var dateToday = date.getFullYear() + \"-\" + ((date.getMonth() + 1) > 1 ? date.getMonth() + 1 : (\"0\" + (date.getMonth() + 1))) + \"-\" + (date.getDate() > 1 ? date.getDate() : (\"0\" + date.getDate()));\r\n      var listDate = [];\r\n      for (let i = 0; i < ngaydi.length; i++) {\r\n        if (new Date(ngaymin) < new Date(formatdate(ngaydi[i].ngay)) && date <= new Date(formatdate(ngaydi[i].ngay))) {\r\n          listDate.push(formatdate(ngaydi[i].ngay))\r\n        }\r\n      }\r\n      // console.log(listDate.sort((a, b) => { return new Date(b) - new Date(a) }));\r\n      listDate.sort(function (a, b) {\r\n        return new Date(a) - new Date(b);\r\n      });\r\n      return listDate[0];\r\n\r\n    }\r\n  }\r\n  const fillDate = () => {\r\n    if (tour.length !== 0) {\r\n      var ngaydi = tour[0];\r\n      var date = new Date();\r\n      var dates = []\r\n      var dateToday = date.getFullYear() + \"-\" + ((date.getMonth() + 1) > 1 ? date.getMonth() + 1 : (\"0\" + (date.getMonth() + 1))) + \"-\" + (date.getDate() > 1 ? date.getDate() : (\"0\" + date.getDate()));\r\n      for (let i = 0; i < ngaydi.length; i++) {\r\n        console.log(dateToday <= formatdate(ngaydi[i].ngay));\r\n        if (date <= new Date(formatdate(ngaydi[i].ngay))) {\r\n          dates.push({ id: i + 1, ngay: ngaydi[i].ngay })\r\n        }\r\n      }\r\n\r\n      return dates\r\n    }\r\n  }\r\n\r\n  const formatlaidate = (e) => {\r\n    if (e) {\r\n      var ngay = e.substr(8, 2)\r\n      var thang = e.substr(5, 2)\r\n      var nam = e.substr(0, 4)\r\n      return ngay + \"/\" + thang + \"/\" + nam\r\n    }\r\n  }\r\n  var tour_ngay = [];\r\n  if (ngaydis && formatlaidate(checkngaydi())) {\r\n    tour_ngay.push(ngaydis.find(x => x.ngay === formatlaidate(checkngaydi())).Tours.find(x => x.id === +id))\r\n  }\r\n  console.log(tour_ngay);\r\n  const hide = () => {\r\n    setState({\r\n      ...state,\r\n      visible3: false,\r\n    });\r\n  };\r\n  const handleVisibleChange = () => {\r\n    setState({ ...state, visible3: true, listdate: fillDate() });\r\n  };\r\n  const users = useSelector(state => state.infor.infor.data);\r\n  useEffect(() => {\r\n    actionngaydi();\r\n    window.scrollTo(0, 0);\r\n\r\n  }, [state.loadlaihoadon])\r\n  const showModal = async () => {\r\n    if (users) {\r\n      var user = await taikhoanApi.getOne(+users.id).then(data => {\r\n        return data;\r\n      })\r\n      setState({\r\n        ...state,\r\n        visible3: false,\r\n        visible: true,\r\n        name: user.name,\r\n        diachi: user.diachi,\r\n        sdt: user.sdt,\r\n        email: user.email\r\n      });\r\n    } else {\r\n      message.warning(\"Bạn cần đăng nhập trước!\")\r\n    }\r\n  };\r\n  const handleOk = e => {\r\n    if (name === \"\" || sdt === \"\" || diachi === \"\" || email === \"\" || !name || !sdt || !diachi || !email) {\r\n      message.warning('Bạn cần cập nhật thông tin cho tài khoản!');\r\n    } else {\r\n      setState({\r\n        ...state,\r\n        visible2: true,\r\n      });\r\n    }\r\n  };\r\n  const handleCancel = e => {\r\n    setState({\r\n      ...state,\r\n      visible: false,\r\n    });\r\n  };\r\n  const thanhtien = (gia_te, gia_eb) => {\r\n    var gianguoilon = checkKhuyenmai();\r\n    return ((gianguoilon * nguoilon) + (gia_te * treem) + (gia_eb * embe));\r\n  }\r\n  const [stylepayment, setstylepayment] = useState(1);\r\n  const callbackfunction = (data) => {\r\n    setstylepayment(data);\r\n  }\r\n  const history = useHistory();\r\n  const handleOk2 = async () => {\r\n    if (state.dieukhoan === false) {\r\n      message.warning(\"Bạn chưa đồng ý điều khoản của chúng tôi!\")\r\n    } else {\r\n      var userId = await taikhoanApi.getOne(+users.id).then(data => {\r\n        return data.id;\r\n      })\r\n      var tourId = id\r\n      let tongtien = thanhtien(tour_ngay[0].giatreem, tour_ngay[0].giaembe)\r\n    }\r\n  };\r\n  const handleCancel2 = e => {\r\n    setState({\r\n      ...state,\r\n      visible2: false,\r\n    });\r\n  };\r\n  const onchange = (e) => {\r\n\r\n    setState({\r\n      ...state,\r\n      [e.target.name]: e.target.value\r\n    })\r\n  }\r\n  const onChangedate = e => {\r\n    setState({ ...state, valueDate: e.target.value });\r\n  };\r\n\r\n  const tinhkhuyenmai = (money, km) => {\r\n    return ((money) - ((money) * (km / 100)))\r\n  }\r\n  const { name, sdt, diachi, email, nguoilon, treem, embe } = state\r\n  const checkKhuyenmai = () => {\r\n    if (giakhuyenmai.Khuyenmais.length === 0) {\r\n      return giakhuyenmai.gianguoilon;\r\n    } else {\r\n      if (giakhuyenmai.Khuyenmais[0].status === 0) {\r\n        return giakhuyenmai.gianguoilon;\r\n      } else {\r\n        return tinhkhuyenmai(giakhuyenmai.gianguoilon, giakhuyenmai.Khuyenmais[0].khuyenmai);\r\n      }\r\n    }\r\n  }\r\n\r\n  const radioStyle = {\r\n    display: 'block',\r\n    height: '30px',\r\n    lineHeight: '30px',\r\n  };\r\n  const adddate = (e) => {\r\n    setState({\r\n      ...state,\r\n      date: state.listdate.find(x => x.id === +e).ngay\r\n    })\r\n  }\r\n  var tong\r\n  if (giakhuyenmai) {\r\n    tong = Number(nguoilon) + Number(treem) + Number(embe);\r\n  }\r\n  return (\r\n    <div id=\"detail-tour\">\r\n      <h1>Hello</h1>\r\n    </div>\r\n\r\n  )\r\n}\r\n\r\nexport default Tour"]},"metadata":{},"sourceType":"module"}